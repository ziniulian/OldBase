<html>
	<head>
		<title>抓取刘亮风场数据</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<script src="../../../../demo/js/LZR/LZR.js"></script>


		<script>
			function init() {
				LZR.HTML5.jsPath = "../../../../demo/js/LZR/";
				LZR.HTML5.loadJs([
					LZR.HTML5.jsPath + "HTML5/util/Ajax.js"
				]);
				var ct = [
					"2015-01-07 00",
					"2015-01-07 01",
					"2015-01-07 02",
					"2015-01-07 03",
					"2015-01-07 04",
					"2015-01-07 05",
					"2015-01-07 06",
					"2015-01-07 07",
					"2015-01-07 08",
					"2015-01-07 09",
					"2015-01-07 10",
					"2015-01-07 11",
					"2015-01-07 12",
					"2015-01-07 13",
					"2015-01-07 14",
					"2015-01-07 15",
					"2015-01-07 16",
					"2015-01-07 17",
					"2015-01-07 18",
					"2015-01-07 19",
					"2015-01-07 20",
					"2015-01-07 21",
					"2015-01-07 22",
					"2015-01-07 23",
					"2015-01-08 00",
					"2015-01-08 01",
					"2015-01-08 02",
					"2015-01-08 03",
					"2015-01-08 04",
					"2015-01-08 05",
					"2015-01-08 06",
					"2015-01-08 07",
					"2015-01-08 08",
					"2015-01-08 09",
					"2015-01-08 10",
					"2015-01-08 11",
					"2015-01-08 12",
					"2015-01-08 13",
					"2015-01-08 14",
					"2015-01-08 15",
					"2015-01-08 16",
					"2015-01-08 17",
					"2015-01-08 18",
					"2015-01-08 19",
					"2015-01-08 20",
					"2015-01-08 21",
					"2015-01-08 22",
					"2015-01-08 23",
					"2015-01-09 00",
					"2015-01-09 01",
					"2015-01-09 02",
					"2015-01-09 03",
					"2015-01-09 04",
					"2015-01-09 05",
					"2015-01-09 06",
					"2015-01-09 07",
					"2015-01-09 08",
					"2015-01-09 09",
					"2015-01-09 10",
					"2015-01-09 11",
					"2015-01-09 12",
					"2015-01-09 13",
					"2015-01-09 14",
					"2015-01-09 15",
					"2015-01-09 16",
					"2015-01-09 17",
					"2015-01-09 18",
					"2015-01-09 19",
					"2015-01-09 20",
					"2015-01-09 21",
					"2015-01-09 22",
					"2015-01-09 23",
					"2015-01-10 00",
					"2015-01-10 01",
					"2015-01-10 02",
					"2015-01-10 03",
					"2015-01-10 04",
					"2015-01-10 05",
					"2015-01-10 06",
					"2015-01-10 07",
					"2015-01-10 08",
					"2015-01-10 09",
					"2015-01-10 10",
					"2015-01-10 11",
					"2015-01-10 12",
					"2015-01-10 13",
					"2015-01-10 14",
					"2015-01-10 15",
					"2015-01-10 16",
					"2015-01-10 17",
					"2015-01-10 18",
					"2015-01-10 19",
					"2015-01-10 20",
					"2015-01-10 21",
					"2015-01-10 22",
					"2015-01-10 23",
					"2015-01-11 00",
					"2015-01-11 01",
					"2015-01-11 02",
					"2015-01-11 03",
					"2015-01-11 04",
					"2015-01-11 05",
					"2015-01-11 06",
					"2015-01-11 07",
					"2015-01-11 08",
					"2015-01-11 09",
					"2015-01-11 10",
					"2015-01-11 11",
					"2015-01-11 12",
					"2015-01-11 13",
					"2015-01-11 14",
					"2015-01-11 15",
					"2015-01-11 16",
					"2015-01-11 17",
					"2015-01-11 18",
					"2015-01-11 19",
					"2015-01-11 20",
					"2015-01-11 21",
					"2015-01-11 22",
					"2015-01-11 23",
					"2015-01-12 00",
					"2015-01-12 01",
					"2015-01-12 02",
					"2015-01-12 03",
					"2015-01-12 04",
					"2015-01-12 05",
					"2015-01-12 06",
					"2015-01-12 07",
					"2015-01-12 08",
					"2015-01-12 09",
					"2015-01-12 10",
					"2015-01-12 11",
					"2015-01-12 12",
					"2015-01-12 13",
					"2015-01-12 14",
					"2015-01-12 15",
					"2015-01-12 16",
					"2015-01-12 17",
					"2015-01-12 18",
					"2015-01-12 19",
					"2015-01-12 20",
					"2015-01-12 21",
					"2015-01-12 22",
					"2015-01-12 23",
					"2015-01-13 00",
					"2015-01-13 01",
					"2015-01-13 02",
					"2015-01-13 03",
					"2015-01-13 04",
					"2015-01-13 05",
					"2015-01-13 06",
					"2015-01-13 07",
					"2015-01-13 08",
					"2015-01-13 09",
					"2015-01-13 10",
					"2015-01-13 11",
					"2015-01-13 12",
					"2015-01-13 13",
					"2015-01-13 14",
					"2015-01-13 15",
					"2015-01-13 16",
					"2015-01-13 17",
					"2015-01-13 18",
					"2015-01-13 19",
					"2015-01-13 20",
					"2015-01-13 21",
					"2015-01-13 22",
					"2015-01-13 23"
				];
				var p = "http://192.168.1.201/bpycserver/api/GrdHandle/getWindData?model=naqpms&isAverage=true&prediction=1&z=1&zone=1&pTime=2015-01-07 00&rowNo=374&columnNo=328&lonmin=50.5&latmin=-4&lonmax=161.5&latmax=58&cTime=";

				// 生成可下载的文件——测试：
				// var blob = new Blob(["Hello World!"],{type:"text/plain"});
				// var blob = new Blob(["Hello World!"],{type:"application/octet-stream"});
				var blob = new Blob(["Hello World!你好吗？"],{type:"text/text", charset:"utf-8"});
				var u = URL.createObjectURL(blob);
				var a = document.createElement("a");
				a.href = u;
				a.innerText = "测试";
				a.download = "测试.txt"
				document.body.appendChild(a);
				document.body.appendChild(document.createElement("br"));
				document.body.appendChild(document.createElement("br"));

				var onload = function (txt) {
					var d = [];
					var ds = JSON.parse(txt);
					for (var i=0; i<ds.length; i++) {
						d.push(ds[i][2]);
						d.push(ds[i][3]);
					}
					var blob = new Blob([JSON.stringify(d)], {type:"text/text;charset=utf-8"});
					var u = URL.createObjectURL(blob);
					this.href = u;
					document.body.appendChild(this);
					document.body.appendChild(document.createElement("br"));
					this.click();
				};

				// 正式生成下载数据
				for (var i=0; i<ct.length; i++) {
					a = document.createElement("a");
					a.innerText = ct[i];
					a.download = ct[i] + ".txt";
					new LZR.HTML5.Util.Ajax ().get (p + ct[i], LZR.bind (a, onload) );
				}
			}
		</script>
	</head>

	<body onload="init()"></body>
</html> 
